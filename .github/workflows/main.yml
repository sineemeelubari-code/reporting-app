name: Reporting Automation

on:
  workflow_dispatch:
    inputs:
      report_type:
        description: "Which report to run?"
        required: true
        default: "daily"
        type: choice
        options:
          - daily
          - weekly
          - monthly
  schedule:
    - cron: "0 9 * * *"   # daily at 9 AM UTC
    - cron: "0 9 * * 0"   # weekly on Sunday at 9 AM UTC
    - cron: "0 9 1 * *"   # monthly on the 1st at 9 AM UTC

jobs:
  daily:
    runs-on: ubuntu-latest
    if: github.event.inputs.report_type == 'daily' || github.event.schedule == '0 9 * * *'
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: "3.9"
      - run: pip install -r requirements.txt
      - run: python daily_summary.py

  weekly:
    runs-on: ubuntu-latest
    if: github.event.inputs.report_type == 'weekly' || github.event.schedule == '0 9 * * 0'
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: "3.9"
      - run: pip install -r requirements.txt
      - run: python weekly_report.py

  monthly:
    runs-on: ubuntu-latest
    if: github.event.inputs.report_type == 'monthly' || github.event.schedule == '0 9 1 * *'
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: "3.9"
      - run: pip install -r requirements.txt
      - run: python monthly_report.py
